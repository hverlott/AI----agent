# SaaS AI System v2.5.1 Release Notes

## ğŸ“… Release Date: 2026-01-13
## ğŸ·ï¸ Version: v2.5.1

### ğŸš€ Key Updates

#### 1. Stability & Bug Fixes
- **Knowledge Base**: 
  - Fixed an issue where user-imported KB entries would disappear after system reload.
  - Implemented reliable "Overwrite by Filename" logic to prevent duplicate obsolete entries.
- **Conversation Engine**:
  - Fixed inconsistency between `CONVERSATION_MODE` config and actual bot tone.
  - Enforced strict "Official Support" constraints (Concise, No Chit-chat) for KB-only replies when configured.
- **Telegram Login Fix**: Resolved async/await errors in Telethon client initialization during login.
- **Session Management**: 
  - Fixed "Account already logged in" (âœ… è¯¥è´¦å·å·²ç™»å½•ï¼) error when re-adding deleted accounts.
  - Implemented secure session metadata storage (`.meta.json`) with token hashing.
  - Added auto-renewal mechanism for sessions.
  - Added "Clear Session" (ğŸ§¹ æ¸…ç†ä¼šè¯) button in Admin Panel for troubleshooting.
- **Group Whitelist**: Fixed an issue where saving the whitelist failed due to invalid group IDs or cache inconsistencies.
- **Broadcast Panel**: Fixed a crash in the broadcast panel caused by missing group IDs in the cache.

#### 2. Enhancements
- **Logging**: 
  - Improved logging structure: Tenant-specific logs in `data/tenants/{tenant_id}/platforms/telegram/logs/`.
  - Added operation auditing for critical actions (whitelist save, broadcast).
- **Security**:
  - Session files now have restricted permissions (0o600).
  - Release packages automatically exclude sensitive files (`.env`, `*.session`).

### ğŸ› ï¸ Upgrade Instructions
1. Backup your `data/` directory.
2. Replace `admin_multi.py` and `src/` directory with the new version.
3. Run `pip install -r requirements.txt` to ensure dependencies are up to date.
4. Restart the Admin Panel (`start_multi_admin.bat`).

### ğŸ§ª Verification
- **System Integrity**: Verified via `tests/system_verify.py` (All checks passed).
- **Regression Testing**: 
  - Whitelist logic verified.
  - Broadcast logic verified.
  - Login flow verified (async fixes).

---
*Generated by Trae AI Assistant*
