# 📁 多平台独立配置指南

## ✨ 新功能说明

每个社交媒体平台现在都有**独立的配置文件**，互不干扰！

---

## 📂 配置文件结构

```
AI Talk/
├── platforms/
│   ├── telegram/                    # Telegram 配置目录
│   │   ├── prompt.txt               # Telegram AI 人设
│   │   ├── keywords.txt             # Telegram 群聊关键词
│   │   └── config.txt               # Telegram 功能开关
│   │
│   └── whatsapp/                    # WhatsApp 配置目录
│       ├── prompt.txt               # WhatsApp AI 人设
│       ├── keywords.txt             # WhatsApp 群聊关键词
│       ├── config.txt               # WhatsApp 功能开关
│       ├── bot.js                   # WhatsApp 机器人程序
│       └── ...
│
├── main.py                          # Telegram 机器人主程序
└── admin_multi.py                   # 多平台管理后台
```

---

## 🎯 为什么需要独立配置？

### 1. **不同平台，不同风格**

- **Telegram**：技术社区，可以更专业、正式
- **WhatsApp**：私人聊天，更亲切、随意
- **微信**：商务场合，礼貌、周到

### 2. **不同关键词**

- **Telegram**：`帮我`, `AI`, `机器人`
- **WhatsApp**：`在吗`, `有空吗`, `帮个忙`
- **微信**：`请问`, `咨询`, `帮忙看下`

### 3. **独立管理**

- 修改 Telegram 配置不影响 WhatsApp
- 可以单独关闭某个平台的功能
- 每个平台的日志独立记录

---

## ⚙️ 配置文件说明

### 1. prompt.txt - AI 人设

**Telegram 示例** (`platforms/telegram/prompt.txt`):
```
你是一个由AI托管的 Telegram 自动回复助手。请用简短、礼貌、幽默的语气回复消息。
绝不要透露你是AI。如果遇到处理不了的问题，回复"稍等，本人稍后回复"。
```

**WhatsApp 示例** (`platforms/whatsapp/prompt.txt`):
```
你是一个由AI托管的 WhatsApp 自动回复助手。请用简短、礼貌、友好的语气回复消息。
保持专业但不失亲切感。如果遇到处理不了的问题，回复"稍等，我稍后回复你"。
```

### 2. keywords.txt - 触发关键词

**Telegram 示例** (`platforms/telegram/keywords.txt`):
```
帮我
求助
AI
机器人
问一下
咨询
```

**WhatsApp 示例** (`platforms/whatsapp/keywords.txt`):
```
帮忙
有空吗
在吗
问个事
咨询下
帮个忙
```

### 3. config.txt - 功能开关

**所有平台通用格式**:
```ini
# 个人消息回复开关
PRIVATE_REPLY=on

# 群消息回复开关
GROUP_REPLY=on
```

---

## 🎛️ 在 Web 管理后台中配置

### 1. 启动管理后台

```cmd
.\start_multi_admin.bat
```

### 2. 选择平台

在左侧栏选择你要配置的平台：
- 💬 **Telegram**
- 💬 **WhatsApp**
- 📘 **Facebook** (开发中)
- 等等...

### 3. 编辑配置

进入 **"🧠 配置"** 标签页：

- **左侧**：编辑 AI 人设
- **右侧**：编辑触发关键词
- **底部**：功能开关（私聊/群聊）

### 4. 保存生效

- 点击 **"💾 保存"** 按钮
- **立即生效**，无需重启机器人！

---

## 📝 配置文件详解

### prompt.txt

| 字段 | 说明 | 示例 |
|------|------|------|
| 身份 | AI 的角色定位 | "你是一个助手" |
| 语气 | 回复的风格 | "幽默的"、"专业的" |
| 限制 | 不能做什么 | "不要透露你是AI" |
| 兜底 | 处理不了的情况 | "稍等，本人稍后回复" |

### keywords.txt

| 规则 | 说明 |
|------|------|
| 每行一个 | 一行代表一个关键词 |
| 不区分大小写 | `AI` 和 `ai` 都能触发 |
| 支持中英文 | 混合使用没问题 |
| `#` 开头为注释 | 方便添加说明 |
| 空行会被忽略 | 可以分段排版 |

### config.txt

| 配置项 | 值 | 说明 |
|--------|-----|------|
| `PRIVATE_REPLY` | `on`/`off` | 是否回复私聊消息 |
| `GROUP_REPLY` | `on`/`off` | 是否回复群聊消息 |

---

## 🔄 热更新机制

所有配置文件支持**热更新**：

1. ✅ **修改文件**：直接编辑 `.txt` 文件
2. ✅ **保存**：保存文件
3. ✅ **立即生效**：下一条消息就会使用新配置
4. ❌ **无需重启**：机器人继续运行

### 工作原理

机器人在**每次处理消息时**都会重新读取配置文件：

```python
# Telegram (main.py)
def handler(event):
    # 每次都重新读取
    prompt = load_system_prompt()
    keywords = load_keywords()
    config = load_config()
    # ...
```

```javascript
// WhatsApp (bot.js)
client.on('message', async (msg) => {
    // 每次都重新加载配置
    loadConfig();
    // ...
});
```

---

## 🎨 配置最佳实践

### 1. Telegram 专业风格

```
你是一个技术型的自动助手，擅长回答编程和技术问题。
请用简洁、专业的语言回复，可以使用技术术语。
```

### 2. WhatsApp 亲切风格

```
你是一个友好的个人助理，像朋友一样聊天。
语气轻松自然，可以用口语化表达，保持礼貌和热情。
```

### 3. 微信商务风格（未来）

```
你是一个专业的客服助手，代表公司回复客户咨询。
语气礼貌、周到，使用敬语，注重服务质量。
```

---

## 🔧 手动配置（不使用 Web 后台）

### 方法一：直接编辑文件

1. 打开对应平台的配置文件
2. 使用任何文本编辑器编辑
3. 保存为 **UTF-8 编码**
4. 配置立即生效

### 方法二：复制模板

```cmd
# 复制 Telegram 配置作为模板
copy platforms\telegram\prompt.txt platforms\facebook\prompt.txt
```

然后修改内容为 Facebook 专用配置。

---

## ❓ 常见问题

### Q1: 修改配置后没有生效？

**A:** 检查以下几点：
1. 文件路径是否正确
2. 文件编码是否为 UTF-8
3. 是否有语法错误（如 `config.txt` 的格式）
4. 查看机器人日志，是否有读取错误

### Q2: 可以在运行时删除配置文件吗？

**A:** 可以！机器人会使用默认配置：
- `prompt.txt` 不存在 → 使用内置默认人设
- `keywords.txt` 不存在 → 群聊只能通过 @ 触发
- `config.txt` 不存在 → 默认开启所有功能

### Q3: 多个平台能共享配置吗？

**A:** 不建议！设计目的就是让每个平台独立配置。
如果确实需要，可以手动复制文件内容。

### Q4: 配置文件支持环境变量吗？

**A:** 目前不支持。如需动态配置，请修改 `.env` 文件。

---

## 📊 配置文件对比

| 平台 | 人设风格 | 关键词示例 | 私聊回复 | 群聊回复 |
|------|---------|-----------|---------|---------|
| **Telegram** | 专业、技术 | `AI`, `机器人` | ✅ | ✅ |
| **WhatsApp** | 亲切、友好 | `在吗`, `帮忙` | ✅ | ✅ |
| **Facebook** | 公开、正式 | `求助`, `咨询` | 🚧 | 🚧 |
| **微信** | 商务、礼貌 | `请问`, `了解` | 🚧 | 🚧 |

---

## 🎓 进阶技巧

### 1. 为不同群组设置不同关键词

虽然目前一个平台只有一个关键词文件，但可以通过修改代码实现：
- 读取群组 ID
- 根据群组 ID 加载不同的关键词文件

### 2. 定时切换人设

编写脚本定时修改 `prompt.txt`：
- 白天：专业风格
- 晚上：轻松风格

### 3. A/B 测试不同人设

- 创建 `prompt_a.txt` 和 `prompt_b.txt`
- 随机选择其中一个加载
- 记录回复效果

---

## 📄 相关文档

- **主文档**：[README.md](README.md)
- **Telegram 指南**：[platforms/telegram/README.md](platforms/telegram/README.md)
- **WhatsApp 指南**：[WHATSAPP_GUIDE.md](WHATSAPP_GUIDE.md)
- **管理后台说明**：[ADMIN_README.md](ADMIN_README.md)

---

## 🎉 总结

✅ **每个平台独立配置**  
✅ **互不干扰**  
✅ **热更新无需重启**  
✅ **Web 后台可视化管理**  
✅ **灵活定制不同风格**  

享受多平台社交媒体管理的便利吧！🚀


